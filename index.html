<!DOCTYPE html>
<html>
<head>
    <title>My Stockfish Bot</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
</head>
<body style="text-align: center; font-family: sans-serif; background-color: #1a1a1a; color: white; padding-top: 50px;">

    <h1>Stockfish Bot</h1>
    
    <div id="board" style="width: 400px; margin: auto; border: 2px solid #555;"></div>
    
    <p style="font-size: 1.2em;">Status: <span id="status">Starting...</span></p>

    <script>
        var board = null;
        var game = new Chess();
        var statusEl = $('#status');

        // 3. THE BRAIN: This looks for the file YOU uploaded to GitHub
        var stockfish = new Worker('stockfish.js');

        function onDrop (source, target) {
            var move = game.move({ from: source, to: target, promotion: 'q' });
            if (move === null) return 'snapback';

            statusEl.html('Stockfish is thinking...');
            
            // Send move to Stockfish
            stockfish.postMessage('position fen ' + game.fen());
            stockfish.postMessage('go depth 10');
        }

        // 4. Handle Stockfish's answer
        stockfish.onmessage = function(event) {
            if (event.data.includes('bestmove')) {
                var move = event.data.split(' ')[1];
                game.move({ from: move.substring(0, 2), to: move.substring(2, 4), promotion: 'q' });
                board.position(game.fen());
                statusEl.html('Your turn!');
            }
        };

        // 5. Build the board
        $(document).ready(function() {
            var config = {
                draggable: true,
                position: 'start',
                onDrop: onDrop,
                pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'
            };
            board = ChessBoard('board', config);
            statusEl.html('Ready! Move a white piece.');
        });
    </script>
</body>
</html>
