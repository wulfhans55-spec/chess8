<!DOCTYPE html>
<html>
<head>
    <title>My Simple Chess Bot</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
</head>
<body style="font-family: Arial; text-align: center; background-color: #f0f0f0;">

    <h1>My Stockfish Bot</h1>
    
    <div id="myBoard" style="width: 400px; margin: auto; border: 5px solid #333;"></div>
    
    <p><b>Status:</b> <span id="status">Your turn! Move a White piece.</span></p>

    <script>
        var board = null;
        var game = new Chess();
        var $status = $('#status');

        // 3. The "Brain": This link is the 'Web-Ready' version of the src files you saw.
        var stockfish = new Worker('https://cdnjs.cloudflare.com/ajax/libs/stockfish.js/10.0.2/stockfish.js');

        // This function runs when you drag and drop a piece
        function onDrop (source, target) {
            var move = game.move({ from: source, to: target, promotion: 'q' });

            if (move === null) return 'snapback'; // If move is illegal, it snaps back

            $status.html('Stockfish is thinking...');
            
            // We send the current board to Stockfish
            stockfish.postMessage('position fen ' + game.fen());
            stockfish.postMessage('go depth 10'); // Skill level: Search 10 moves deep
        }

        // This handles Stockfish's "Reply"
        stockfish.onmessage = function(event) {
            if (event.data.includes('bestmove')) {
                var moveData = event.data.split(' ')[1];
                
                // Make the move on the internal logic
                game.move({ from: moveData.substring(0, 2), to: moveData.substring(2, 4), promotion: 'q' });
                
                // Update the visual board
                board.position(game.fen());
                $status.html('Your turn!');
            }
        };

        // Basic settings for the board
        var config = {
            draggable: true,
            position: 'start',
            onDrop: onDrop
        };
        board = ChessBoard('myBoard', config);
    </script>
</body>
</html>
